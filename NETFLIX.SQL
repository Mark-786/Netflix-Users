-- 1) Creating a database
CREATE database Netflix;
-- 2) Using the database
USE Netflix;
-- 3) Running the SELECT query
SELECT * FROM netflix_userbase;
-- 4) Renaming the table in dataset
RENAME TABLE netflix.netflix_userbase TO netflix_users;
-- 5) Changing column name subscription type to subscriptions
ALTER TABLE netflix_users
 CHANGE COLUMN `Subscription Type` subscription VARCHAR(20);

-- 6) Checking list of users with basic subscription
 SELECT * FROM netflix_users 
  WHERE subscription = 'Basic';
 
-- 7) Checking list of users from United States
SELECT * FROM netflix_users
 WHERE Country = 'United States';
 
-- 8) Counting total number of users
SELECT count(*) FROM netflix_users;

-- 9) Finding average age of users
SELECT AVG(Age) AS Average_Age FROM netflix_users;

-- 10) List unique subscription plans
SELECT DISTINCT Subscription FROM netflix_users;

-- 11) Total revenue generated
SELECT SUM(`Monthly Revenue`) AS total_revenue FROM netflix_users;

-- 12) Earliest Join date
SELECT MIN(`Join Date`) AS Earliest_Join FROM netflix_users;

-- 13) latest payment date
SELECT MAX(`Last Payment Date`) AS Latest_Payment_Date FROM netflix_users;

-- 14) Count users from each country 
SELECT Country, COUNT(*) AS users FROM netflix_users
 GROUP BY Country;

-- 15) Find the average age for each subscription plan
SELECT Subscription, AVG(`Age`) AS Average_Age FROM netflix_users
 GROUP BY Subscription;

-- 16) users who are older than 30
SELECT * FROM netflix_users
 WHERE Age > 30;

-- 17) Total number of male & female users
SELECT Gender, COUNT(*) AS Gender_Count
 FROM netflix_users
  GROUP BY Gender;

-- 18) Highest monthly revenue
SELECT MAX(`Monthly Revenue`) AS Highest_Revnue FROM netflix_users;

-- 19) Total renevue per country
SELECT Country, SUM(`Monthly Revenue`) AS total_revenue 
 FROM netflix_users GROUP BY Country;

-- 20) Users who use Smart TV as their device type:
SELECT * FROM netflix_users
 WHERE Device = 'Smart TV';

-- 21) Find the average age of users from each country
SELECT Country, AVG(Age) FROM netflix_users
 GROUP BY Country;

-- 22) Users who have a premium subscription and are younger than 30:
SELECT * FROM netflix_users
 WHERE Subscription = 'Premium' AND Age < 30;
 
 -- 23) oldest and youngest user
 SELECT MAX(Age) AS Oldest_User, MIN(Age) AS Youngest_user
  FROM netflix_users;

-- 24) Count the number of user for each device
SELECT Device, COUNT(*) AS Number_of_Users FROM netflix_users
 GROUP BY Device;
 
-- 25) Find the average monthly revenue for each subscription plan
SELECT Subscription, AVG(`Monthly Revenue`) AS Average_Monthly_Revenue 
 FROM netflix_users
  GROUP BY Subscription;

-- 26) List users who have a basic subscription and are from a specific country, e.g., 'Canada'
SELECT * FROM netflix_users
 WHERE Subscription = 'Basic' AND Country = 'Canada';

-- 27) Find the top 5 countries with the highest number of users:
SELECT Country, COUNT(*) AS Total_users FROM netflix_users
 GROUP BY Country 
  ORDER BY Total_users DESC
   LIMIT 5;

-- 28) Get users who joined before a specific date, e.g., '2022-01-01'
SELECT * FROM netflix_users
 WHERE `Join Date` < '2022-01-01';

-- 29) Find the total revenue generated by users aged 30 and above
SELECT SUM(`Monthly Revenue`) AS Total_Revenue FROM netflix_users
 WHERE Age  >= 30;

-- 30) Find the average age of users who have a premium subscription
SELECT AVG(Age) AS Average_Age FROM netflix_users
 WHERE subscription = 'Premium';

-- 31) Count the number of users for each age, grouped by gender
SELECT Age, Gender , COUNT(Age) AS Count_of_Age 
 FROM netflix_users GROUP BY Age, Gender
  ORDER BY Age ASC;








